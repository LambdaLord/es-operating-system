#summary How to build the ES support libraries for x86 PC.
#labels Build-Support

= Building the ES support libraries =

The ES operating system uses many open source libraries for 2D graphics, regular expression support, etc. You need to build these libraries in the following order before building the ES operating system itself.

In the following steps, we will set up the ES cross libraries in '/opt/es'. If you need to set up them in the other place, please modify your `--prefix` and other options accordingly.

= PCRE =

The Perl Compatible Regular Expressions (PCRE) library is used for the regular expression support.

{{{
$ cd src
$ wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-7.2.tar.bz2
$ tar -jxvf pcre-7.2.tar.bz2
$ patch -p0 -d . < ../es-operating-system/patches/pcre-7.2.patch
$ cd ..
$ mkdir pcre
$ cd pcre
$ ../src/pcre-7.2/configure --prefix=/opt/es --disable-shared --enable-utf8 --enable-unicode-properties --host=i386-pc-es --target=i386-pc-es
$ make
$ make install
}}}

= !FreeType 2 =

!FreeType 2 is used as a software font engine. Please download `freetype-2.3.5.tar.bz2` from http://sourceforge.net/project/showfiles.php?group_id=3157 into your `src` directory to install.

{{{
$ cd src
$ tar -jxvf freetype-2.3.5.tar.bz2
$ patch -p0 -d . < ../es-operating-system/patches/freetype-2.3.5.patch
$ cd ..
$ mkdir freetype
$ cd freetype
$ ../src/freetype-2.3.5/configure --prefix=/opt/es --host=i386-pc-es --target=i386-pc-es
$ make FTSYS_SRC=../src/freetype-2.3.5/builds/unix/ftsystem.c
$ make install
}}}

= Expat =

The Expat XML Parser is used as an XML parser for fontconfig, which is installed next.
Please download `expat-2.0.1.tar.gz` from http://sourceforge.net/project/showfiles.php?group_id=10127&package_id=10780&release_id=513851 into your `src` directory to install.

{{{
$ cd src
$ tar -zxvf expat-2.0.1.tar.gz
$ patch -p0 -d . < ../es-operating-system/patches/expat-2.0.1.patch
$ cd ..
$ mkdir expat
$ cd expat
$ ../src/expat-2.0.1/configure --prefix=/opt/es --host=i386-pc-es --target=i386-pc-es
$ make
$ make install
}}}

*Note:* If you encounter an error during 'make install', please correct the generated Makefile as below:

{{{
install: xmlwf/xmlwf installlib
        $(mkinstalldirs) $(DESTDIR)$(bindir) $(DESTDIR)$(man1dir)
        $(LIBTOOL) --mode=install $(INSTALL_PROGRAM) xmlwf/xmlwf.elf $(DESTDIR)$(bindir)/xmlwf
        $(INSTALL_DATA) $(MANFILE) $(DESTDIR)$(man1dir)

}}}

= Fontconfig =

Fontconfig is used for font customization and configuration for cairo, which is installed next.

{{{
$ cd src
$ wget http://fontconfig.org/release/fontconfig-2.4.2.tar.gz
$ tar -zxvf fontconfig-2.4.2.tar.gz
$ patch -p0 -d . < ../es-operating-system/patches/fontconfig-2.4.2.patch
$ cd ..
$ mkdir fontconfig
$ cd fontconfig
$ ../src/fontconfig-2.4.2/configure --prefix=/opt/es --host=i386-pc-es --target=i386-pc-es --with-arch=i386-pc-es --with-expat-includes=/opt/es/include --with-expat-lib=/opt/es/lib --with-freetype-config=/opt/es/bin/freetype-config --with-default-fonts=/file/fonts --with-cache-dir=/file --with-confdir=/file
$ make
$ make install
}}}

Note in the above configure command, the following three options specify the path to the directory in the target PC which is executing the ES operating system:

|| Option || Value || Description ||
|| --with-default-fonts || /file/fonts || Use fonts from /file when config is busted ||
|| --with-cache-dir || /file || Use /file to store cache files ||
|| --with-confdir || /file || Use /file to store configuration files ||

= Cairo =

Cairo is used for the 2D graphics.

{{{
$ cd src
$ wget http://cairographics.org/releases/cairo-1.4.10.tar.gz
$ tar -zxvf cairo-1.4.10.tar.gz
$ patch -p0 -d . < ../es-operating-system/patches/cairo-1.4.10.patch
$ cd ..
$ mkdir cairo
$ cd cairo
$ ../src/cairo-1.4.10/configure --prefix=/opt/es --host=i386-pc-es --target=i386-pc-es --disable-png --disable-xlib --disable-ps --disable-svg FREETYPE_CFLAGS='-I/opt/es/include/freetype2 -I/opt/es/include' FREETYPE_LIBS='-L/opt/es/lib -lfreetype' FONTCONFIG_CFLAGS=-I/opt/es/include FONTCONFIG_LIBS='-L/opt/es/lib -lfontconfig'
$ make
$ make install
}}}

= Fonts =

Currently, ES uses the Sazanami fonts (http://sourceforge.jp/projects/efont/) and the liberation fonts (https://www.redhat.com/promo/fonts/). If these fonts are not installed in your host operating system, please install them, too (with yum, or apt-get, etc.)

Your support libraries now set up!